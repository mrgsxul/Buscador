<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Buscador de Catálogo por ID</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    .fade-in { animation: fadeIn .3s ease both; }
    @keyframes fadeIn { from { opacity:0; transform: translateY(6px);} to { opacity:1; transform: none;} }
  </style>
</head>

<body class="bg-gray-100 min-h-screen p-4 flex justify-center items-start">

  <div class="bg-white shadow-xl rounded-2xl p-6 w-full max-w-2xl">
    
    <h1 class="text-3xl font-bold text-center mb-4">Buscar Producto por ID</h1>

    <p class="text-center text-gray-600 mb-4">
      Escribe un número de ID para obtener el link de tu catálogo.
    </p>

    <div class="d-flex gap-2 mb-3">
      <input 
        id="inputId"
        type="number"
        class="form-control p-3"
        placeholder="Ejemplo: 1"
      >
      <button class="btn btn-primary px-4" onclick="buscar()">Buscar</button>
    </div>

    <div id="mensaje"></div>
    <div id="resultado" class="mt-4"></div>

  </div>


<script>
  let catalogo = null;

  // Cargar el JSON automáticamente al abrir la página
  async function cargarCatalogo() {
    try {
      const resp = await fetch("./catalogo.json");
      catalogo = await resp.json();
      console.log("Catálogo cargado:", catalogo);
    } catch (error) {
      document.getElementById("mensaje").innerHTML =
        `<div class="alert alert-danger">No se pudo cargar catalogo.json</div>`;
      console.error(error);
    }
  }

  cargarCatalogo();


  function buscar() {
    const id = parseInt(document.getElementById("inputId").value);
    const mensaje = document.getElementById("mensaje");
    const resultado = document.getElementById("resultado");

    mensaje.innerHTML = "";
    resultado.innerHTML = "";

    if (isNaN(id)) {
      mensaje.innerHTML = `<div class="alert alert-warning text-center">Ingresa un número válido.</div>`;
      return;
    }

    if (!catalogo || !catalogo.products) {
      mensaje.innerHTML =
        `<div class="alert alert-danger text-center">El catálogo no está cargado.</div>`;
      return;
    }

    const prod = catalogo.products.find(p => Number(p.id) === id);

    if (!prod) {
      mensaje.innerHTML = `<div class="alert alert-danger text-center">No existe un producto con ese ID.</div>`;
      return;
    }

    // Mostrar tarjeta del producto
    resultado.innerHTML = `
      <div class="card fade-in">
        ${prod.image_url ? `<img src="${prod.image_url}" class="card-img-top" alt="Imagen">` : ""}
        <div class="card-body">
          <h5 class="card-title">${prod.title || "Sin título"}</h5>

          <p class="text-muted small">ID: ${prod.id}</p>

          <div class="d-grid gap-2">
            <a href="${prod.link}" class="btn btn-primary" target="_blank">
              Abrir enlace
            </a>
            ${prod.page_url ? `
              <a href="${prod.page_url}" class="btn btn-outline-secondary" target="_blank">
                Ver página
              </a>` : ""}
          </div>
        </div>
      </div>
    `;
  }
</script>

</body>
</html>
